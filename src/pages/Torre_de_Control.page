<apex:page cache="false" doctype="html-5.0" showheader="false" sidebar="false" controller="Ctrl_Torre_de_Control"  standardstylesheets="false" applyBodyTag="false" >
    <head>        
        <meta charset="utf-8"></meta>
        <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>        
        <apex:stylesheet value="{!URLFOR($Resource.zipCalculadora,'/ZipCalculadora/css/font-awesome.min.css')}"/>
        <apex:stylesheet value="{!URLFOR($Resource.AnimatedCSS)}"/>
        <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed" rel="stylesheet" />        
        <apex:stylesheet value="{!URLFOR($Resource.MD, 'material-dashboard-html-v2.1.0/assets/css/material-dashboard.css?v=2.1.0.css')}" />
        <!--CSS principal de la pagina-->
        <apex:stylesheet value="{!URLFOR($Resource.TorreControlCSS)}" />
        <style>
            body{
                overflow-x: hidden;
            }
        </style>

        <title>Torre de Control CEC</title>
    </head>        

        <div ng-app="tower" class="bg-dark text-light" style="font-family: 'Roboto Condensed', sans-serif;">
            
            <div class="container" ng-controller="llenaTabla">                        
                <div class="row">
                    <div class="col">
                        <br />
                        <br />
                        <br />
                            <h2 class="display-3">Torre de Control CEC</h2>
                    </div>
                    <div class="col text-right">
                        <img  src="{!URLFOR($Resource.logo_uvm)}" />
                    </div>
                </div>
                <br/>
                <div class="row">

                    <div class="card card-nav-tabs">
                      <div class="card-header card-header-danger">
                        <h4 class="card-title">Datos generales sub-campaña Contact Center</h4>
                      </div>
                      <div class="card-body">
                        <div class="row">
                            <div class="col-6">
                                <div class="input-group mb-3">
                                  <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1">Nombre de la sub-campaña CEC</span>
                                  </div>
                                  <input required="true" ng-model="nombreCampania" type="text" class="form-control" placeholder="campaña" aria-describedby="basic-addon1" />
                                </div>
                            </div>

                            <div class="col-6">
                                
                                <div class="input-group mb-3">
                                  <div class="input-group-prepend">
                                    <span class="input-group-text" id="basic-addon1">Fecha de inicio</span>
                                  </div>
                                  <input required="true" ng-model="fechaInicio" type="date" class="form-control" placeholder="DD/MM/AAAA" aria-describedby="basic-addon1" min="2018-01-08" />
                                </div>
                            </div>

                            <div class="col-6">

                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <label class="input-group-text">Tipo de campaña :</label>
                                    </div>
                                    <select ng-model="tipoCampania" class="custom-select" name="sel_tipo_campana" >
                                        <option value="0">-- Selecciona --</option>
                                        <option value="Batch">Batch</option>
                                        <option value="En Linea">En Linea</option>
                                        <option value="Foto">Foto</option>
                                    </select>
                                </div>
                                <br />
                            </div>
                            
                            <div class="col-6">
                                
                                <div class="input-group mb-3">
                                  <div class="input-group-prepend">
                                    <span class="input-group-text" >Fecha de final</span>
                                  </div>
                                  <input ng-model="fechaFin" type="date" class="form-control" placeholder="DD/MM/AAAA" aria-describedby="basic-addon1" />
                                </div>
                            </div>

                        </div>
                      </div>
                    </div>
                    
                    <div class="col"></div>
                </div>                        
                <br/>

                <div class="row">

                    <div class="card card-nav-tabs">
                      <div class="card-header card-header-danger">
                          <h4 class="card-title">Filtros</h4>
                      </div>
                      <div class="card-body">
                        <div class="row">                            
                            <div class="col-3">
                                
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <label class="input-group-text">Campo :</label>
                                    </div>
                                    <select required="true" class="custom-select" ng-model="miCampoSeleccionado" ng-change="miCampoChange()" ng-options="campo as campo.name for campo in campos track by campo.name" >
                              
                                    </select>
                                </div>
                            </div>
                            <div class="col-3">
                                
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <label class="input-group-text">Filtro :</label>
                                    </div>
                                    <select class="custom-select" ng-model="miOperadorSeleccionado" ng-options="operador as operador.name for operador in operadores track by operador.name  ">
                              
                                    </select>
                                </div>
                            </div>
                            <div  class="col-4">
                                
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <label class="input-group-text">Valor:</label>
                                    </div>
                                    <ng-container ng-if="tipoActivo=='REFERENCE' || tipoActivo=='PICKLIST'">
                                        <select multiple="true" class="custom-select" ng-model="miValorSeleccionado" ng-change="seleccionarValor(miValorSeleccionado)" ng-options="valor as valor.name for valor in valores track by valor.name" >                            
                                        </select>
                                    </ng-container>
                                    <ng-container ng-if="tipoActivo=='STRING'">
                                        <input type="text" ng-model="miValorSeleccionadoTexto" ng-change="seleccionarValor(miValorSeleccionadoTexto)" class="form-control" placeholder="Escriba valor" aria-describedby="basic-addon1" />
                                    </ng-container>
                                    <ng-container ng-if="tipoActivo=='DOUBLE'">
                                        <input type="text" ng-model="miValorSeleccionadoDouble" ng-change="seleccionarValor(miValorSeleccionadoDouble)" class="form-control" placeholder="Escriba valor" aria-describedby="basic-addon1" />
                                    </ng-container>
                                    <ng-container ng-if="tipoActivo=='DATETIME' || tipoActivo=='DATE'">
                                        <input type="date" format="dd/MM/yyyy" ng-model="miValorSeleccionadoDate" ng-change="seleccionarValor(miValorSeleccionadoDate)" class="form-control" placeholder="DD/MM/AAAA" aria-describedby="basic-addon1" />
                                    </ng-container>
                                    <ng-container ng-if="tipoActivo=='BOOLEAN'">
                                        <select  class="custom-select" ng-model="miValorSeleccionadoBool" ng-change="seleccionarValor(miValorSeleccionadoBool)" ng-options="valor as valor.name for valor in valoresBool track by valor.name" >                            
                                        </select>
                                    </ng-container>
                                </div>
                            </div>
                            <div class="col-2">
                                
                                <a class="btn btn-danger text-light btn-block" href=""  ng-click="agregarFiltro()" ><i class="fa fa-plus"></i> Agregar </a>     
                            </div>
                        </div> 
                        <div class="row animated bounceInLeft"  ng-repeat="seleccionado in seleccionados">
                        <div class="col-4 text-right">
                            <span ng-bind="seleccionado.campo.name"></span>&nbsp;
                            <span ng-bind="seleccionado.operador.name"></span>
                            <br />
                        </div>                          
                        <div class="col-4"> 
                            <input ng-if="seleccionado.campo.tipo!='DATE' && seleccionado.campo.tipo!='DATETIME'" ng-disabled="seleccionado.editar" style="width:100%;display:initial;" type="text" ng-model="seleccionado.valor.name" class="form-control" placeholder="Escriba valor" aria-describedby="basic-addon1" />

                            <input ng-if="seleccionado.campo.tipo=='DATE' || seleccionado.campo.tipo=='DATETIME'" ng-disabled="seleccionado.editar" style="width:100%;display:initial;" type="date" ng-model="seleccionado.valor.name" class="form-control" placeholder="Escriba valor" aria-describedby="basic-addon1" />

                            <br />
                        </div>
                        <div class="col-2">
                            <button  class="btn btn-danger btn-block" ng-click="eliminarFiltro($index, seleccionado)" aria-label="Remove"><i class="fa fa-times"></i> Eliminar</button>
                            <br />
                        </div>
                        <div class="col-2">
                            <button ng-if="seleccionado.editar"  class="btn btn-success btn-block" ng-click="makeEditable(seleccionado)" aria-label="Remove"><i class="fa fa-edit"></i> Editar</button>
                            <button ng-if="!seleccionado.editar" class="btn btn-info btn-block" ng-click="saveEditable(seleccionado)" aria-label="Remove"><i class="fa fa-save"></i> Guardar</button>
                            <br />
                        </div>              
                
                    </div> 
                    <div class="row">
                        <div class="col-5"></div>
                        <div class="col-2">
                            <a ng-if="permiteBuscar" href="" class="btn btn-danger text-light btn-block" ng-click="opo()" ><i class="fa fa-search"> Buscar </i> </a>
                        </div>
                        <div class="col-5"></div>
                    </div>



                      </div>
                    </div>                
                </div>
                   

          <!-- <label>Valores: <span ng-bind="seleccionado.valor.name"></span> </label> -->
             <div class="row">
                <div class="panel-group card card-nav-tabs">
                  <div class="panel panel-default">
                    <div class="panel-heading card-header card-header-danger">
                      <h4 class="panel-title card-title">
                        <a data-toggle="collapse" href="#collapse1">Gráficos</a>
                      </h4>
                    </div>
                    <div id="collapse1" style="margin-top: 3%;" class="panel-collapse collapse">
                        <div class="row text-light">
                            <div class="col">
                                <ng-container ng-if="true">
                                    <div class="card card-chart">
                                      <div class="card-header card-header-success">
                                        <div id="roundedLineChart" class="ct-chart"></div>
                                      </div>
                                      <div class="card-body">
                                        <h4 class="card-title">Prioridad</h4>
                                        <p class="card-category"></p>
                                      </div>
                                    </div>
                                </ng-container>
                            </div>
                            <div class="col">
                                <ng-container ng-if="true">
                                    <div class="card card-chart">
                                      <div class="card-header card-header-primary">
                                        <div id="straightLinesChart" class="ct-chart ct-chart2"></div>
                                      </div>
                                      <div class="card-body">
                                        <h4 class="card-title">Estrategia</h4>
                                        <p class="card-category"></p>
                                      </div>
                                    </div>
                                </ng-container>
                            </div>
                            <div class="col">
                                <ng-container ng-if="true">
                                    <div class="card card-chart">
                                      <div class="card-header card-header-info">
                                        <div id="simpleBarChart" class="ct-chart ct-chart3"></div>
                                      </div>
                                      <div class="card-body">
                                        <h4 class="card-title ">Intentos</h4>
                                        <p class="card-category"></p>
                                      </div>
                                    </div>
                                </ng-container>
                            </div>
                        </div>
                    </div>
                  </div>
                </div>
            </div>

            <!--
            <div class="card card-nav-tabs" data-toggle="collapse" data-target="#demo">
                <div class="card-header card-header-danger">
                    <h4 class="card-title">Graficos</h4>
                </div>
                 <div id="demo" class="container" style="margin-top: 5%;">                
                    <div class="row text-light">
                        <div class="col">
                            <ng-container ng-if="true">
                                <div class="card card-chart">
                                  <div class="card-header card-header-success">
                                    <div id="roundedLineChart" class="ct-chart"></div>
                                  </div>
                                  <div class="card-body">
                                    <h4 class="card-title">Prioridad</h4>
                                    <p class="card-category"></p>
                                  </div>
                                </div>
                            </ng-container>
                        </div>
                        <div class="col">
                            <ng-container ng-if="true">
                                <div class="card card-chart">
                                  <div class="card-header card-header-primary">
                                    <div id="straightLinesChart" class="ct-chart ct-chart2"></div>
                                  </div>
                                  <div class="card-body">
                                    <h4 class="card-title">Estrategia</h4>
                                    <p class="card-category"></p>
                                  </div>
                                </div>
                            </ng-container>
                        </div>
                        <div class="col">
                            <ng-container ng-if="true">
                                <div class="card card-chart">
                                  <div class="card-header card-header-info">
                                    <div id="simpleBarChart" class="ct-chart ct-chart3"></div>
                                  </div>
                                  <div class="card-body">
                                    <h4 class="card-title ">Intentos</h4>
                                    <p class="card-category"></p>
                                  </div>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                </div>
            </div>
-->


                <div class="row">                        
                    <div class="card card-nav-tabs">
                      <div class="card-header card-header-danger">
                        <h4 class="card-title">Registros</h4>
                      </div>
                      <div class="card-body">
                        <h4 class="card-title">Total Registros: <span format="number" class="display-4 text-danger" id="totalReg"></span>                            
                        </h4>
                        <div class="row">
                            <div class="table-responsive">
                                <ng-container ng-if="verTablaOpps">

                                    <table class="table table-sm table-striped">
                                      <thead class="bg-danger text-light">
                                        <tr>
                                            <th scope="col">#</th>
                                            <th scope="col"><div style="width:500px; ">Nombre</div></th>
                                            <th scope="col"><div style="width:80px; ">Nivel</div></th>
                                            <th scope="col"><div style="width:80px; ">Campus</div></th>
                                            <th scope="col"><div style="width:80px; ">Team</div></th>
                                            <th scope="col"><div style="width:100px; ">Tipo de Team</div></th>
                                            <th scope="col"><div style="width:180px; ">Prioiridad de Oportunidad</div></th>
                                            <th scope="col"><div style="width:55px; ">Score 1</div></th>
                                            <th scope="col"><div style="width:55px; ">Score 2</div></th>
                                            <th scope="col">Attemps</th>
                                            <th scope="col"><div style="width:140px; ">Contador de Toques</div></th>
                                            <th scope="col">Origen</th>
                                            <th scope="col"><div style="width:100px; ">Origen Actual</div></th>
                                            <th scope="col"><div style="width:100px; ">Canal Actual</div></th>
                                            <th scope="col"><div style="width:100px; ">Tipo de base</div></th>
                                            <th scope="col"><div style="width:50px; ">Nivel</div></th>
                                            <th scope="col"><div style="width:150px; ">Campaña CEC</div></th>
                                            <th scope="col"><div style="width:130px; ">Sub-Campaña CEC</div></th>
                                            <th scope="col"><div style="width:170px; ">Ultimo toque call center</div></th>
                                        </tr>
                                      </thead>
                                      <tbody id="toportunidad">  
                                      </tbody>  
                                    </table>
                                </ng-container>
                            </div>
                        </div>                  
                      </div>                
                    </div>              
                </div>            
                <br/>
                <div class="row">

                    <div class="card card-nav-tabs">
                      <div class="card-header card-header-danger">
                        <h4 class="card-title">Asignación, Priorización y Edición</h4>
                      </div>
                      <div class="card-body">
                         <div class="row ">
                    
                            <div class="col-4"> 
                            <br />
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <label class="input-group-text">Tipo de Team :</label>
                                    </div>
                                    <select ng-model="callCenterSeleccionado" ng-change="seleccionaCallCenter()" class="custom-select" >    
                                        <option value="0">-- Selecciona --</option>
                                        <option>Brittel</option>
                                        <option>8x8 CN</option>                            
                                        <option>8x8 VO</option>                            
                                    </select>                        
                                </div>
                            </div>
                            <div class="col-4">
                            <br />
                                <div class="input-group mb-3">

                                    <div class="input-group-prepend">
                                        <label class="input-group-text">Team:</label>
                                    </div>

                                    <select class="custom-select" ng-model="campaniaSeleccionada" ng-options="valor as valor for valor in campanias track by valor" > 
                                        <option value="0">-- Seleccione --</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-4">
                                <br />
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <label class="input-group-text">Prioridad:</label>
                                    </div>
                                    <select ng-model="prioridadLetra" class="custom-select" >                         
                                        <option>-Seleccione-</option>
                                        <option>A</option>
                                        <option>B</option>
                                        <option>C</option>                            
                                        <option>D</option> 
                                        <option>E</option>                           
                                    </select>
                                    <select ng-model="prioridadNumero" class="custom-select" >
                                        <option>-Seleccione-</option>
                                        <option>0</option>
                                        <option>1</option>                            
                                        <option>2</option> 
                                        <option>3</option>
                                        <option>4</option>                            
                                        <option>5</option>                            
                                        <option>6</option>                            
                                        <option>7</option>                            
                                        <option>8</option>                            
                                        <option>9</option>                            
                                        <option>10</option>                            
                                        <option>11</option>                            
                                        <option>12</option>                            
                                        <option>13</option>                           
                                        <option>14</option>
                                        <option>15</option>
                                        <option>16</option>
                                        <option>17</option>
                                        <option>18</option> 
                                        <option>19</option> 
                                        <option>20</option>                            
                                    </select>
                                </div>
                            </div>
                            <div class="col-4">                                
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <label class="input-group-text">Score 2:</label>
                                    </div>
                                    <input ng-model="score2" type="text" maxlength="3" class="form-control" />                            
                                </div>
                            </div>                
                            
                            <div class="col-4">

                                
                            </div>
                            
                            <div class="col-4">
                                <a ng-click="aplicar()" class="btn btn-danger text-light btn-block" href="">Aplicar</a>
                                <!--<button class="btn btn-rose btn-fill" onclick="swal('Any fool can use a computer')">Try me!</button>-->
                                <br />                                
                            </div>
                        </div>
                      </div>
                    </div>
                </div>
               
                <br />
                <br />
            </div>
            <span id="Query">Query</span>
            <br/>
            <span id="IdCampania">Id campania: </span>
        </div>



        <div class="modal fade" id="loadingModal" tabindex="-1" role="dialog" data-keyboard="false" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" >

            <div class="modal-dialog">

                <div class="modal-content">

                    <div class="modal-body">

                        <i class="fa fa-spinner fa-pulse fa-2x fa-fw"></i>

                        <span id="messageLoadinModal"> Cargando ...</span>

                    </div>

                </div>

            </div>

        </div>

    <!-- Librerias de Script -->
    <!-- ---------------------------------------------------------------------------------------- -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.7.2/angular.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2"></script>
    <!-- Chartist JS -->
    <script src="{!URLFOR($Resource.MD, 'material-dashboard-html-v2.1.0/assets/js/plugins/chartist.min.js')}"></script>

    <!--aqui se encuentra toda la logica y funcionalidad de la pagina-->
    <script src="{!URLFOR($Resource.TorreControlLogic)}" charset="utf-8"></script>
    <!-- ---------------------------------------------------------------------------------------- -->

</apex:page>